---
id: chatchannelcontroller 
title: ChatChannelController
slug: /referencedocs/sources/streamchat/controllers/channelcontroller/chatchannelcontroller
---

`ChatChannelController` is a controller class which allows mutating and observing changes of a specific chat channel.

``` swift
public class _ChatChannelController<ExtraData: ExtraDataTypes>: DataController, DelegateCallable, DataStoreProvider 
```

`ChatChannelController` objects are lightweight, and they can be used for both, continuous data change observations (like
getting new messages in the channel), and for quick channel mutations (like adding a member to a channel).

Learn more about `ChatChannelController` and its usage in our [cheat sheet](https://github.com/GetStream/stream-chat-swift/wiki/StreamChat-SDK-Cheat-Sheet#channel).

> 

Learn more about using custom extra data in our [cheat sheet](https://github.com/GetStream/stream-chat-swift/wiki/Cheat-Sheet#working-with-extra-data).

## Inheritance

[`DataController`](../DataController), [`DelegateCallable`](../DelegateCallable), [`DataStoreProvider`](../../Database/DataStoreProvider)

## Properties

### `statePublisher`

A publisher emitting a new value every time the state of the controller changes.

``` swift
public var statePublisher: AnyPublisher<DataController.State, Never> 
```

### `channelChangePublisher`

A publisher emitting a new value every time the channel changes.

``` swift
public var channelChangePublisher: AnyPublisher<EntityChange<_ChatChannel<ExtraData>>, Never> 
```

### `messagesChangesPublisher`

A publisher emitting a new value every time the list of the messages matching the query changes.

``` swift
public var messagesChangesPublisher: AnyPublisher<[ListChange<_ChatMessage<ExtraData>>], Never> 
```

### `memberEventPublisher`

A publisher emitting a new value every time member event received.

``` swift
public var memberEventPublisher: AnyPublisher<MemberEvent, Never> 
```

### `typingMembersPublisher`

A publisher emitting a new value every time typing members change.

``` swift
public var typingMembersPublisher: AnyPublisher<Set<_ChatChannelMember<ExtraData.User>>, Never> 
```

### `observableObject`

A wrapper object that exposes the controller variables in the form of `ObservableObject` to be used in SwiftUI.

``` swift
public var observableObject: ObservableObject 
```

### `channelQuery`

The ChannelQuery this controller observes.

``` swift
@Atomic public private(set) var channelQuery: _ChannelQuery<ExtraData>
```

### `cid`

The identifier of a channel this controller observes.
Will be `nil` when we want to create direct message channel and `id`
is not yet generated by backend.

``` swift
public var cid: ChannelId? 
```

### `client`

The `ChatClient` instance this controller belongs to.

``` swift
public let client: _ChatClient<ExtraData>
```

### `channel`

The channel the controller represents.

``` swift
public var channel: _ChatChannel<ExtraData>? 
```

To observe changes of the channel, set your class as a delegate of this controller or use the provided
`Combine` publishers.

### `messages`

The messages of the channel the controller represents.

``` swift
public var messages: LazyCachedMapCollection<_ChatMessage<ExtraData>> 
```

To observe changes of the messages, set your class as a delegate of this controller or use the provided
`Combine` publishers.

### `listOrdering`

Describes the ordering the messages are presented.

``` swift
public var listOrdering: ListOrdering = .topToBottom 
```

> 

### `areTypingEventsEnabled`

`true` if the channel has typing events enabled. Defaults to `false` if the channel doesn't exist yet.

``` swift
var areTypingEventsEnabled: Bool 
```

### `areReactionsEnabled`

`true` if the channel has reactions enabled. Defaults to `false` if the channel doesn't exist yet.

``` swift
var areReactionsEnabled: Bool 
```

### `areRepliesEnabled`

`true` if the channel has replies enabled. Defaults to `false` if the channel doesn't exist yet.

``` swift
var areRepliesEnabled: Bool 
```

### `areReadEventsEnabled`

`true` if the channel has read events enabled. Defaults to `false` if the channel doesn't exist yet.

``` swift
var areReadEventsEnabled: Bool 
```

### `areUploadsEnabled`

`true` if the channel supports uploading files/images. Defaults to `false` if the channel doesn't exist yet.

``` swift
var areUploadsEnabled: Bool 
```

## Methods

### `synchronize(_:)`

``` swift
override public func synchronize(_ completion: ((_ error: Error?) -> Void)? = nil) 
```

### `setDelegate(_:)`

Sets the provided object as a delegate of this controller.

``` swift
public func setDelegate<Delegate: _ChatChannelControllerDelegate>(_ delegate: Delegate)
        where Delegate.ExtraData == ExtraData 
```

> 

#### Parameters

  - delegate: The object used as a delegate. It's referenced weakly, so you need to keep the object alive if you want keep receiving updates.

### `updateChannel(name:imageURL:team:members:invites:extraData:completion:)`

Updated channel with new data.

``` swift
func updateChannel(
        name: String?,
        imageURL: URL?,
        team: String?,
        members: Set<UserId> = [],
        invites: Set<UserId> = [],
        extraData: ExtraData.Channel,
        completion: ((Error?) -> Void)? = nil
    ) 
```

#### Parameters

  - team: New team.
  - members: New members.
  - invites: New invites.
  - extraData: New `ExtraData`.
  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `muteChannel(completion:)`

Mutes the channel this controller manages.

``` swift
func muteChannel(completion: ((Error?) -> Void)? = nil) 
```

#### Parameters

  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `unmuteChannel(completion:)`

Unmutes the channel this controller manages.

``` swift
func unmuteChannel(completion: ((Error?) -> Void)? = nil) 
```

#### Parameters

  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `deleteChannel(completion:)`

Delete the channel this controller manages.

``` swift
func deleteChannel(completion: ((Error?) -> Void)? = nil) 
```

#### Parameters

  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `truncateChannel(completion:)`

Truncates the channel this controller manages.

``` swift
func truncateChannel(completion: ((Error?) -> Void)? = nil) 
```

Removes all of the messages of the channel but doesn't affect the channel data or members.

#### Parameters

  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `hideChannel(clearHistory:completion:)`

Hide the channel this controller manages from queryChannels for the user until a message is added.

``` swift
func hideChannel(clearHistory: Bool = false, completion: ((Error?) -> Void)? = nil) 
```

#### Parameters

  - clearHistory: Flag to remove channel history (**false** by default)
  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `showChannel(completion:)`

Removes hidden status for the channel this controller manages.

``` swift
func showChannel(completion: ((Error?) -> Void)? = nil) 
```

#### Parameters

  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `loadPreviousMessages(before:limit:completion:)`

Loads previous messages from backend.

``` swift
func loadPreviousMessages(
        before messageId: MessageId? = nil,
        limit: Int = 25,
        completion: ((Error?) -> Void)? = nil
    ) 
```

#### Parameters

  - messageId: ID of the last fetched message. You will get messages `older` than the provided ID.
  - limit: Limit for page size.
  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `loadNextMessages(after:limit:completion:)`

Loads next messages from backend.

``` swift
func loadNextMessages(
        after messageId: MessageId? = nil,
        limit: Int = 25,
        completion: ((Error?) -> Void)? = nil
    ) 
```

#### Parameters

  - messageId: ID of the current first message. You will get messages `newer` than the provided ID.
  - limit: Limit for page size.
  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `sendKeystrokeEvent(completion:)`

Sends the start typing event and schedule a timer to send the stop typing event.

``` swift
func sendKeystrokeEvent(completion: ((Error?) -> Void)? = nil) 
```

This method is meant to be called every time the user presses a key. The method will manage requests and timer as needed.

#### Parameters

  - completion: a completion block with an error if the request was failed.

### `sendStartTypingEvent(completion:)`

Sends the start typing event.

``` swift
func sendStartTypingEvent(completion: ((Error?) -> Void)? = nil) 
```

For the majority of cases, you don't need to call `sendStartTypingEvent` directly. Instead, use `sendKeystrokeEvent`
method and call it every time the user presses a key. The controller will manage
`sendStartTypingEvent`/`sendStopTypingEvent` calls automatically.

#### Parameters

  - completion: a completion block with an error if the request was failed.

### `sendStopTypingEvent(completion:)`

Sends the stop typing event.

``` swift
func sendStopTypingEvent(completion: ((Error?) -> Void)? = nil) 
```

For the majority of cases, you don't need to call `sendStopTypingEvent` directly. Instead, use `sendKeystrokeEvent`
method and call it every time the user presses a key. The controller will manage
`sendStartTypingEvent`/`sendStopTypingEvent` calls automatically.

#### Parameters

  - completion: a completion block with an error if the request was failed.

### `createNewMessage(text:pinning:attachments:mentionedUserIds:quotedMessageId:extraData:completion:)`

Creates a new message locally and schedules it for send.

``` swift
func createNewMessage(
        text: String,
        pinning: MessagePinning? = nil,
//        command: String? = nil,
//        arguments: String? = nil,
        attachments: [AnyAttachmentPayload] = [],
        mentionedUserIds: [UserId] = [],
        quotedMessageId: MessageId? = nil,
        extraData: ExtraData.Message = .defaultValue,
        completion: ((Result<MessageId, Error>) -> Void)? = nil
    ) 
```

#### Parameters

  - text: Text of the message.
  - pinning: Pins the new message. `nil` if should not be pinned.
  - attachments: An array of the attachments for the message. `Note`: can be built-in types, custom attachment types conforming to `AttachmentEnvelope` protocol and `ChatMessageAttachmentSeed`s.
  - quotedMessageId: An id of the message new message quotes. (inline reply)
  - extraData: Additional extra data of the message object.
  - completion: Called when saving the message to the local DB finishes.

### `addMembers(userIds:completion:)`

Add users to the channel as members.

``` swift
func addMembers(userIds: Set<UserId>, completion: ((Error?) -> Void)? = nil) 
```

#### Parameters

  - users: Users Id to add to a channel.
  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `removeMembers(userIds:completion:)`

Remove users to the channel as members.

``` swift
func removeMembers(userIds: Set<UserId>, completion: ((Error?) -> Void)? = nil) 
```

#### Parameters

  - users: Users Id to add to a channel.
  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `markRead(completion:)`

Marks the channel as read.

``` swift
func markRead(completion: ((Error?) -> Void)? = nil) 
```

#### Parameters

  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `enableSlowMode(cooldownDuration:completion:)`

Enables slow mode for the channel

``` swift
func enableSlowMode(cooldownDuration: Int, completion: ((Error?) -> Void)? = nil) 
```

When slow mode is enabled, users can only send a message every `cooldownDuration` time interval.
`cooldownDuration` is specified in seconds, and should be between 1-120.
For more information, please check [documentation](https://getstream.io/chat/docs/javascript/slow_mode/?language=swift).

#### Parameters

  - cooldownDuration: Duration of the time interval users have to wait between messages. Specified in seconds. Should be between 1-120.
  - completion: Called when the API call is finished. Called with `Error` if the remote update fails.

### `disableSlowMode(completion:)`

Disables slow mode for the channel

``` swift
func disableSlowMode(completion: ((Error?) -> Void)? = nil) 
```

For more information, please check [documentation](https://getstream.io/chat/docs/javascript/slow_mode/?language=swift).

#### Parameters

  - completion: Called when the API call is finished. Called with `Error` if the remote update fails.

### `freezeChannel(completion:)`

Freezes the channel.

``` swift
func freezeChannel(completion: ((Error?) -> Void)? = nil) 
```

Freezing a channel will disallow sending new messages and sending / deleting reactions.
For more information, see https://getstream.io/chat/docs/ios-swift/freezing\_channels/?language=swift

#### Parameters

  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.

### `unfreezeChannel(completion:)`

Unfreezes the channel.

``` swift
func unfreezeChannel(completion: ((Error?) -> Void)? = nil) 
```

Freezing a channel will disallow sending new messages and sending / deleting reactions.
For more information, see https://getstream.io/chat/docs/ios-swift/freezing\_channels/?language=swift

#### Parameters

  - completion: The completion. Will be called on a **callbackQueue** when the network request is finished. If request fails, the completion will be called with an error.
